<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kr.co.main.myRecord.plan.MyRecordPlanMapper">
	<select id="willdo" resultType="kr.co.main.myRecord.plan.MyRecordPlanVO">
		SELECT p.title, p.start_date,'YYYY-MM-DD', p.end_date,'YYYY-MM-DD', p.num_of_people, SUM(d.budget) as budget FROM wego.plan p, wego.plan_detail d
		<where>
			p.plan_pk = d.plan_pk and p.state = 0
		</where>
		GROUP BY p.Plan_pk
	</select>
	<select id="alldone" resultType="kr.co.main.myRecord.plan.MyRecordPlanVO">
		SELECT p.title, p.start_date, p.end_date, p.num_of_people, SUM(d.budget) FROM wego.plan p, wego.plan_detail d
		<where>
			p.plan_pk = d.plan_pk and p.state = 1
		</where>
		GROUP BY p.plan_pk
	</select>
	<select id="tempSaved" resultType="kr.co.main.myRecord.plan.MyRecordPlanVO">
		SELECT p.title, p.start_date, p.end_date, p.num_of_people, SUM(d.budget) FROM wego.plan p, wego.plan_detail d
		<where>
			p.plan_pk = d.plan_pk and p.state = 2
		</where>
		GROUP BY p.plan_pk
	</select>
	
	<select id="countWilldo" parameterType="kr.co.main.myRecord.plan.MyRecordPlanVO" resultType="int">
		SELECT COUNT(*) FROM wego.plan p, wego.plan_detail d
		<where>
			p.plan_pk = d.plan_pk and p.state = 0
		</where>
		GROUP BY p.Plan_pk 
	</select>
	<select id="countAllDone" parameterType="kr.co.main.myRecord.plan.MyRecordPlanVO" resultType="int">
		SELECT COUNT(*) FROM wego.plan p, wego.plan_detail d
		<where>
			p.plan_pk = d.plan_pk and p.state = 1
		</where>
		GROUP BY p.Plan_pk 
	</select>
	<select id="countTempSaved" parameterType="kr.co.main.myRecord.plan.MyRecordPlanVO" resultType="int">
		SELECT COUNT(*) FROM wego.plan p, wego.plan_detail d
		<where>
			p.plan_pk = d.plan_pk and p.state = 2
		</where>
		GROUP BY p.Plan_pk 
	</select>
</mapper>